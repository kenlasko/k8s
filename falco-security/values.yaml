driver:
  kind: modern-bpf
collectors:
  enabled: true
  docker:
    enabled: false
  crio:
    enabled: false
  containerd:
    enabled: true
    socket: /run/k3s/containerd/containerd.sock

extra:
  env:
  - name: FALCOSIDEKICK_UI_USER
    valueFrom:
      secretKeyRef:
        name: userinfo
        key: userpass
customRules:
  custom-rules.yaml: |-
    - rule: Example rule
      desc: Test rule
      condition: evt.type = execve and proc.name = malicious and proc.pid = 1
      output: The process %proc.name has used the syscall %evt.type
      priority: notice
falcosidekick:
  enabled: true
  webui:
    enabled: true
    affinity: 
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist
            - key: kubernetes.io/arch
              operator: In
              values: 
              - 'amd64' 
    redis:
      enabled: true
      affinity: 
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: node-role.kubernetes.io/control-plane
                operator: DoesNotExist
              - key: kubernetes.io/arch
                operator: In
                values: 
                - 'amd64' 
