immich:
  persistence:
    library:
      existingClaim: nfs-pictures
env:
  DB_HOSTNAME:
    secretKeyRef:
      name: immich-secrets
      key: DB_HOSTNAME
  DB_DATABASE_NAME:
    secretKeyRef:
      name: immich-secrets
      key: DB_DATABASE_NAME
  DB_USERNAME:
    secretKeyRef:
      name: immich-secrets
      key: DB_USERNAME
  DB_PASSWORD:
    secretKeyRef:
      name: immich-secrets
      key: DB_PASSWORD
  REDIS_URL:
    secretKeyRef:
      name: immich-secrets
      key: REDIS_URL

route:
  main:
    enabled: true
    kind: HTTPRoute
    parentRefs:
    - name: tls
      namespace: cilium
      sectionName: https
    hostnames:
    - "immich.ucdialplans.com"
    rules:
    - backendRefs:
      - name: immich
        namespace: media-apps
        kind: Service
        port: 2283

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/control-plane
          operator: DoesNotExist
        - key: kubernetes.io/arch
          operator: In
          values: 
          - "amd64"