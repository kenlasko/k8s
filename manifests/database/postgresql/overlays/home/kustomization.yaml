apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: postgresql
helmCharts:
- name: cloudnative-pg
  repo: https://cloudnative-pg.github.io/charts
  version: 0.26.0
  releaseName: postgresql
  namespace: postgresql
  valuesFile: ../../base/values.yaml
  # additionalValuesFiles:
  # - values.yaml
  # valuesMerge: merge

resources:
- ../../base
# - backup.yaml
- cluster.yaml
- cronjob-akeyless-update.yaml
- external-secrets.yaml
- service.yaml
- serviceaccount.yaml
- volume.yaml

configMapGenerator:
- name: update-akeyless-script
  files:
  - ../../scripts/update-cloud-certs.sh
  options:
    disableNameSuffixHash: true