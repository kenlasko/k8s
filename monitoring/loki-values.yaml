loki:
  enabled: true
  persistence:
    enabled: true
    storageClassName: longhorn
    size: 20Gi
  limits:
    cpu: 1000m
    memory: 2048Mi
  requests:
    cpu: 500m
    memory: 512Mi
  nodeSelector: 
    server-type: "nuc"
promtail:
  enabled: true
  extraScrapeConfigs:
  - job_name: syslog
    syslog:
      listen_address: 0.0.0.0:1514
      label_structured_data: yes
      labels:
        job: "syslog"
    relabel_configs:
    - source_labels: ["__syslog_connection_ip_address"]
      target_label: "ip_address"
    - source_labels: ["__syslog_message_severity"]
      target_label: "severity"
    - source_labels: ["__syslog_message_facility"]
      target_label: "facility"
    - source_labels: ["__syslog_message_hostname"]
      target_label: "host"
  extraPorts:
    name: tcp-syslog
    containerPort: 1514
    protocol: TCP
    service:
      type: ClusterIP
      port: 1514
  resources:
    limits:
      cpu: 300m
      memory: 300Mi
    requests:
      cpu: 200m
      memory: 250Mi
  initContainer:
    - name: init
      image: docker.io/busybox:1.33
      imagePullPolicy: IfNotPresent
      command:
        - sh
        - -c
        - sysctl -w fs.inotify.max_user_instances=512
      securityContext:
        privileged: true

