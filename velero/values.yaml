configuration:
  backupStorageLocation:
  - name: nas-s3
    provider: aws
    bucket: kube
    default: true
    config:
      s3Url: http://nas01.ucdialplans.com:8010
      s3ForcePathStyle: true
      region: "default"
  volumeSnapshotLocation:
  - name: nas-s3
    provider: csi
  features: EnableCSI
  defaultBackupStorageLocation: nas-s3
  defaultVolumeSnapshotLocations: csi:nas-s3
  defaultSnapshotMoveData: true

deployNodeAgent: true
nodeAgent:
  podSecurityContext:
    runAsUser: 0
  containerSecurityContext:
    privileged: true
    allowPrivilegeEscalation: true
    readOnlyRootFilesystem: false

credentials:      
  useSecret: true
  existingSecret: s3-credentials

initContainers:
- name: velero-plugin-for-aws
  image: velero/velero-plugin-for-aws:latest
  imagePullPolicy: Always
  volumeMounts:
  - mountPath: /target
    name: plugins

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/control-plane
          operator: DoesNotExist
        - key: kubernetes.io/arch
          operator: In
          values: 
          - 'amd64'
