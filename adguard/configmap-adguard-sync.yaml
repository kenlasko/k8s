apiVersion: v1
kind: ConfigMap
metadata:
  name: adguard-sync-config
  namespace: adguard
  labels:
    app: adguard
    argocd.argoproj.io/instance: adguard
data:
  adguardhome-sync.yaml: |
    # cron expression to run in daemon mode. (default; "" = runs only once)
    cron: "*/10 * * * *"

    # runs the synchronisation on startup
    runOnStart: true

    origin:
      url: http://adguard-web:3000
      apiPath: /control
      insecureSkipVerify: true
      username: $ADGUARD_USERNAME
      password: $ADGUARD_PASSWORD

    replicas:
      - url: https://adguard-rpi1.ucdialplans.com'
        username: $ADGUARD_USERNAME
        password: $ADGUARD_PASSWORD
      - url: https://adguard-rpi2.ucdialplans.com'
        username: $ADGUARD_USERNAME
        password: $ADGUARD_PASSWORD

    # Configure the sync API server, disabled if api port is 0
    api:
      port: 8080
      # if username and password are defined, basic auth is applied to the sync API
      username: $ADGUARD_USERNAME
      password: $ADGUARD_PASSWORD

    # Configure sync features; by default all features are enabled.
    features:
      generalSettings: true
      queryLogConfig: true
      statsConfig: true
      clientSettings: true
      services: true
      filters: true
      dhcp:
        serverConfig: true
        staticLeases: true
      dns:
        serverConfig: true
        accessLists: true
        rewrites: true