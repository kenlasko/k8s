rollOutCiliumPods: true
# routingMode: native             # Original
routingMode: tunnel               # New
tunnelProtocol: geneve            # New
ipv4NativeRoutingCIDR: 10.0.0.0/9
# autoDirectNodeRoutes: true      # Original
# tunnel: disabled                # Original
bpf:
  hostRouting: true
  masquerade: true
ipam:
  mode: kubernetes
cluster:
  name: home
  id: 0
loadBalancer:                     # New
  mode: dsr                       # New
  dsrDispatch: geneve             # New
l2announcements:
  enabled: true
  leaseDuration: 6s
  leaseRenewDeadline: 2s
  leaseRetryPeriod: 200ms
envoy:
  enabled: true
  rollOutPods: true
externalIPs:
  enabled: true
extraEnv:
- name: TZ
  value: "America/Toronto"
kubeProxyReplacement: true
k8sServiceHost: localhost
k8sServicePort: 7445  # Needs to be 7445 for Talos
## This is for Talos
securityContext:
  capabilities:
    ciliumAgent: 
    - CHOWN
    - KILL
    - NET_ADMIN
    - NET_RAW 
    - IPC_LOCK
    - SYS_ADMIN
    - SYS_RESOURCE
    - DAC_OVERRIDE
    - FOWNER
    - SETGID
    - SETUID
    cleanCiliumState: 
    - NET_ADMIN
    - SYS_ADMIN
    - SYS_RESOURCE
cgroup:
  autoMount:
    enabled: false
  hostRoot: /sys/fs/cgroup


hubble:
  peerService:
    clusterDomain: cluster.local
  relay:
    enabled: true
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist
            - key: kubernetes.io/arch
              operator: In
              values: 
              - 'amd64'
  ui:
    enabled: true
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist
            - key: kubernetes.io/arch
              operator: In
              values: 
              - 'amd64'
    service:
      annotations:
        omni-kube-service-exposer.sidero.dev/port: "50080"
        omni-kube-service-exposer.sidero.dev/label: Hubble
        omni-kube-service-exposer.sidero.dev/icon: |
          H4sICNFZJmYAA2xvZ28tZGFya2JnLWhvcml6b250YWwtY29sb3Iuc3ZnAG1YTW8cRw6951c0lHu7
          SBaLrEUUIO7dQIfJVYfcAsRrGXDsYCNE+fn7HrtnRh/WZfC6WUXy8bP1w19/f1yePv3++HB7I1Nu
          locPnz4+PN7ehN4sf3/68PT+6z+3N21pC94ufPjfT58/3958+frlw83yzx+fv/x1e/Pw+Pjnv969
          e3p6Wp9s/fq/j++0tfYOV9/8+N0Pf/72+LD8fnvzi+pqPWKxsYr2k8Zqs/uC3zY17yzWnmmnrqub
          61nseLx0X8Xd7o5jp5e3/Xo27Pv/pDVrN+++pdnn6he93tY+Mt7oLaGz1pF4KPpGK4WuOsf7KVt8
          W6foGleltoZk+Bulu9RZq8oa+Q2tJXVV+/PcTH5+qbYuRKh6rLjBT/j19LlY7ld6rCNmnAau0jEu
          csfzxcea3fLuOHd6dd9VeUz/6Sf/tnLta7dxVS6+9obYvVZ+ljsrN0NI4q3yQ+6Z5xJd7RXhq4wm
          V49i1RbNLp4LyGwtL2Se5Y7nF8+Pc6dX912Vz9iGzW8rP3t0Vn72/LXys9xZ+dnz18rfeL7Nf7+P
          V+k9ZTUTo/CYaduEEotJHM37Mg1KW+FUWWZfTQ13+9q6+TZ9VXch1u62zIHn6sSjzcLZouTn7Pea
          64wmPDZ99AV4OFIYuOUcxJaeVKNCrQlfdG60wkaw3ucQmIHg9qj6TwEl8GKE9DPeZluRYxe85IQ+
          HZfzwC166VMV2xJ6Ju9PFBGoSxTT2DHtXXKsYQp75jpGgzzc9IGSbKt5g7yvLjkWE9g9jLiNifdg
          U+Bvgt3oFanWF6COtFoMHDt+L3igZHNuF4xUtuZ8P+p2sDW05KcTw5psvkGbDkVWtnVoUnl0hLTL
          6uQextrIXFARig5C46EF2NamrZwNRBzQBzgFF7isE88xdQNX7on3CH3genA7rBX20OIeuW9nzAwK
          wT2X97xXtbCMSiFXK2zSjbnQmyVxm6lMGY1W9qQmzgeadFnXQu77wK8ig5BYY+DUWEdnnuK5gpPO
          Soy6RWgUfJ3aqSSMRuEyAyeVt+QEReOtEi5UC9scG/MPTYIQTcToQxiaEfGMJBbphYf3fgIH3aWu
          Ry+q/Gs2fa//kOLUvDqhpzkpt0ZOYE4L3/PJZnkDKhDgnAwByqSjHBJUJNKxM60M6aR4b1GUDUQa
          WBTXIsLphgQTJoJUBqgghIJ0R9UiQVpCbaI8qA4J1QfcuuDB9EcCnjGrXOt9zl75GyQX96n1Sm+f
          I3l/T85T4X31frJ8UR7oHUL7OgRYPt7Faf/MUeXHsoB77rFXd2tB99X36a6BnsR8V0RDwU5WsY3B
          YkeIk/kOq2ktekxkg/U41o3QIozcg6SsljWZ7gmSdO9o+DtVBxyFh2ecXnXEX3+RVoN20YYG6/Ne
          oBfJdCeNzS7uj+d3h9xxYJ97yvcwpB3yeHXPx6OfXkrhlLDV9sKDaqxmx51AX7pfjr0UwzkYiop4
          a54yee1q3i53HIjxxjzKZ170vJDCKVSgNj1GWm6CZJNzioNuQbLJ7g5oc2DoLYjhFJugWdms48qe
          Jmxm+GW9TsQWVYmCrnruo42NWCjv7MBYcpCbzqbFTluo6g8xlAljkKkIHrGWMcCae9dQkcJovDA5
          wjvEca5rdcSGsUNMJXBhYIwX9iqXaZonwi77HoQyL8ZA0R1tnCb3x/PtwOzLM7uUj+hZvBZzWgt3
          KZwNU4Q4qmrDUS1FEYyH0Z1iZFAKzkzcTnOkfGQ2ku85q+1i1JF/xmecMcQp9/y974TzMdJdyLQW
          RbOZQh6R2dXpxD5FnFYceZ+0BjOyV0uBnxsh9ktyFKPPeo176XtyAl5wsrF2cqazY5lxRSSyOAu0
          ggPzXHf08cKYuOU7il0cbraabSmOSAOjfGlHl9HrfSA2ncfoltPA3WyMoZJXr2Fn2iiPi6xoaGi9
          hTF+iNGKkHd9stkwz5QzmBjtgDjRRsqvkZ15alI0I8a0j4uO77TpvvmJqhfNmlUmaIWk+chMlElW
          kDlqjo0S+b+HcZ7L7O4oO9RfIOWHH/WIpVA5eu6Nk4j3Fh5syTqZTMG46d6SyVNwFamNBZvSLi/s
          iszVkpfiBbgb6pYYWUiMTyKUDHBjV4X7wusap3otUDln4QaalBk/5yYD90QtXFk04mOItBIrzCAm
          PQeGPAa1+7P34FvHvgBiUiDU4IMQHR9RGlwOrAaKYDfBkojuoTVwBrKSuHHhEm5Ie8vNRC91ZGWM
          a88baPYiJ/7OrH3P2Cp5vNuJamoUwDgtpTELeaUebCokCNRuIWZyTaEEYfCgc0rhx5wejZ1A59Ta
          cUljUUCajuC0qqHE9Zv8iNTXC+iznT+Ga8db8a/j+p7h8+P2vod/7nv4FCzQmAgrqxrWhjaGlweT
          fIfTuuAWVgsuBve4KzwQl+BOOp7JYUjw3sEZjLgE6nj/Hjj0IJ96+QVC0PKy6vRqJ0f/fOZHcrPS
          Z+9rOyTG2ob7Mext7veh5UKe22F9bxjLCB/EKL/yM6xQcBMYrHkIo99GhSiStcu1n06i9lCchble
          MaeRrBvxtKoJlBZqGWscRxqyCl8PesUc3Makwh6MlpZV+1WK/LjZcdby3xEzYialsTMhKYkxE3kt
          WuMur6O2JZTQLJ/nvi31tII+K9fbTpnX4KXV6AdkrD59kh9qWViyClWsZTHMrwIuV8rLrSqjClN7
          BcT23Yt4Y8DYFy/vGdAojhTJUAGfe+En5srGhJhRfcMx9ytBGswx5ic/Yqtt1WoYVWkv2tjl2/Tp
          4dPjh/oy5b9+fvzu//7EgHFcEgAA

gatewayAPI:
  enabled: true
  secretsNamespace:
    create: false
    name: cilium
    sync: true


operator:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: node-role.kubernetes.io/control-plane
            operator: DoesNotExist
          - key: kubernetes.io/arch
            operator: In
            values: 
            - 'amd64'