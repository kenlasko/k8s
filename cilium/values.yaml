rollOutCiliumPods: true
# routingMode: native             # Original
routingMode: tunnel               # New
tunnelProtocol: geneve            # New
ipv4NativeRoutingCIDR: 10.0.0.0/9
# autoDirectNodeRoutes: true      # Original
# tunnel: disabled                # Original
bpf:
  hostRouting: true
  masquerade: true
ipam:
  mode: kubernetes
cluster:
  name: home
  id: 0
loadBalancer:                     # New
  mode: dsr                       # New
  dsrDispatch: geneve             # New
l2announcements:
  enabled: true
  leaseDuration: 6s
  leaseRenewDeadline: 2s
  leaseRetryPeriod: 200ms
envoy:
  enabled: true
  rollOutPods: true
externalIPs:
  enabled: true
extraEnv:
- name: TZ
  value: "America/Toronto"
kubeProxyReplacement: true
k8sServiceHost: localhost
k8sServicePort: 7445  # Needs to be 7445 for Talos
## This is for Talos
securityContext:
  capabilities:
    ciliumAgent: 
    - CHOWN
    - KILL
    - NET_ADMIN
    - NET_RAW 
    - IPC_LOCK
    - SYS_ADMIN
    - SYS_RESOURCE
    - DAC_OVERRIDE
    - FOWNER
    - SETGID
    - SETUID
    cleanCiliumState: 
    - NET_ADMIN
    - SYS_ADMIN
    - SYS_RESOURCE
cgroup:
  autoMount:
    enabled: false
  hostRoot: /sys/fs/cgroup


hubble:
  peerService:
    clusterDomain: cluster.local
  relay:
    enabled: true
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist
            - key: kubernetes.io/arch
              operator: In
              values: 
              - 'amd64'
  ui:
    enabled: true
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: node-role.kubernetes.io/control-plane
              operator: DoesNotExist
            - key: kubernetes.io/arch
              operator: In
              values: 
              - 'amd64'
    service:
      annotations:
        omni-kube-service-exposer.sidero.dev/port: "50080"
        omni-kube-service-exposer.sidero.dev/label: Hubble
        omni-kube-service-exposer.sidero.dev/icon: |
          H4sICL1YJmYAA2h1YmJsZS5zdmcAxVbbbuIwEP0Vy7y0DzG+xLeKIBUK25fVrrTbl32p0hBI1EBQ
          kkLbr98xgTaQdG9CWiFyOR77zJmxZzIoNwu0TWdVEmDJDUZJnC6SKsBcMYw2abwd5c8BpogiGEY7
          dJ5mWYBX+SrG6HmZrcoAJ1W1vur3t9st2QqSF4s+p5T2YXE8HCzD8hGlswCnUb66B+z+/gGjsnrJ
          4gC7Qa96WcdXYbZOQowccLdKK1j1qYyLb+swir+s7kpHBo5g9LK7fuTzcLAOq2Tv41ORXfTeWcNL
          jMCNz6AmgYkbsL+lr7g/HPQd63Cw2LG35j1cYjeWgytpBfREd6ua/RdV0T+qml06d4v8EfztTehE
          TkYHwNv7QRQXB25HwQRhWnhM+0RzsYFRwqT8rCzhfhtmXBLBeBs3jAjTtudCE1+27bkVRPK2vfAt
          kbaN+1QSpTpwxYgWbVwyTQxt41aAvRGw8YnSPPEY99UbyKgh2m+hyieGnaKcU2LMHt0lZlH/G0nt
          zefzOo/McCRFwpQmQujN/n4L8Oth7gJFWbr23PRWWuNmWpnPrtn0NK2CWN1I65JLQ4SvEJPgr9Ue
          hMMYD5INTqPmS8IkRIhnDrOoxrzmC0jcWfw4VInexAgqqHO8TWdgf+wXOBedGlk21t10zBBO/Sad
          +Cs60aab2rGA+B7RGdjFRsNWMEQaWy/QVGc76EyTznyoTlt5fS276YRPLByGc9JN4URAATii4xZK
          ANurE2fNndVjJWw3XUPduejG9mak6eFIzeJ5ORwU4SwNs0/uFq+qk/IOZTyqi3VUV+siwNAOF3vr
          D8r7Yfh7Ea7KeV4sXXeoivT5goJrlEjkceVDf3XXHeC6TVnla5TP52VcuX4jfHeG87UX5VkOtL0b
          637O+SNL1m1Wg2/9qxZ9rPU32qPza4dqawWoFxISZPmvIyDVaQSmaqqnphUBoqXptvyjILi6+tXt
          vmP5Me4o1tW7qt1jFlbxBWcaGd1oydZsGOWHjnxYHx7rHee+kYY/AW4+6+6GCQAA

gatewayAPI:
  enabled: true
  secretsNamespace:
    create: false
    name: cilium
    sync: true


operator:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: node-role.kubernetes.io/control-plane
            operator: DoesNotExist
          - key: kubernetes.io/arch
            operator: In
            values: 
            - 'amd64'