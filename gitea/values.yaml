containerSecurityContext:
  allowPrivilegeEscalation: false
  seccompProfile:
    type: RuntimeDefault
  capabilities:
    drop: ["ALL"]

  # Add the SYS_CHROOT capability for root and rootless images if you intend to
  # run pods on nodes that use the container runtime cri-o. Otherwise, you will
  # get an error message from the SSH server that it is not possible to read from
  # the repository.
  # https://gitea.com/gitea/helm-chart/issues/161
    # add:
    # - SYS_CHROOT
  privileged: false
  readOnlyRootFilesystem: true
  runAsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      nodeSelectorTerms:
      - matchExpressions:
        - key: node-role.kubernetes.io/control-plane
          operator: DoesNotExist
        - key: kubernetes.io/arch
          operator: In
          values: 
          - 'amd64'

persistence:
  enabled: true
  claimName: nfs-gitea
  size: 10Gi
  accessModes: ["ReadWriteOnce"]
  storageClass: nfs

gitea:
  admin:
    existingSecret: gitea-creds
    email: 'ken.lasko@gmail.com'
  config:
    database:
      DB_TYPE: mariadb
    session:
      PROVIDER: db
    cache:
      ADAPTER: memory
    queue:
      TYPE: level
    indexer:
      ISSUE_INDEXER_TYPE: bleve
      REPO_INDEXER_ENABLED: true
  additionalConfigFromEnvs:
    - name: GITEA__DATABASE__HOST
      value: mariadb.mariadb.svc.cluster.local
    - name: GITEA__DATABASE__PASSWD
      valueFrom:
        secretKeyRef:
          name: gitea-creds
          key: password


postgresql:
  enabled: false
redis-cluster:
  enabled: false
postgresql-ha:
  enabled: false

